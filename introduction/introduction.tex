\input{../settings/boilerplate}
\chapter{Introduction}\label{Introduction}.  


Regime shifts are one of the most dramatic signatures of complex systems â€“ the ability to experience sudden transitions in their behavior and patterns is an example of the emergent properties that set such systems apart. These shifts, or tipping points, can be found in many different contexts and can occur for different reasons that may never be encapsulated by a single theory.   Understanding and forecasting these events challenges the capacity of our models, our statistical methods and our available data.  How much can we learn about these systems, what are the best predictions we can make with the knowledge we have, and how do we make sound management decisions in face of such uncertainty?  

Ecological regime shifts may include the sudden collapse of fisheries or forests, eutrophication of lakes and rivers, or tipping points from carbon cycle feedback loops of global climate change.  Evolutionary regime shifts may include major transitions such as the invasion of new habitat or the development of a novel trait.  A regime of a complex system can be defined as a set of typical patterns or rules describing its behavior.  While we may neither understand nor be able to predict everything about this regime, we can say something about what outcomes we expect and what we do not.   A mathematical model may capture these patterns and behavior within the regime, matching what has already been observed and even predicting future events with reasonable accuracy.  A shift in regime brakes these rules or patterns, driving the system into another patter of behavior, or alternative stable state.  Although our ability to model and predict a complex system is greatest within a regime, many of the most significant dynamics may occur by large and sudden changes that are difficult to anticipate.  


The chapters of my thesis represent rather than exhaust the suite of different contexts in which I have explored these phenomena.  The selection of these chapters also captures the progression of my research trajectory in various lenses.  The first trajectory is that of computational and data-driven research.  A numerical simulation is present in Chapter~\ref{fluctuationdomains}, but pencil-and-paper calculations are in the focus.  By Chapter~\ref{warningsignals}, my analytical work is still essential, but I have learned to use it as a launching point for my computational approaches, rather than an ends by themselves.  The second trajectory is in problem scope -- from a technical question interesting to a niche community, to the larger and rapidly growing area of phylogenetics, to the more immediately relevant problem of suddenly collapsing ecosystems.  In the process, I have become most attracted to problems not for pure mathematical elegance, but their potential relevance.  The third trajectory has been towards increasing openness and reproducible research by making all the products of the research effort available.  Chapters~\ref{pmc} and~\ref{warningsignals}, and much else besides, are captured as they unfolded each day through the pages of my open laboratory notebook.  The texts, code, and data accompanying each of these works are fully available as self-contained R packages.  


If regime shifts are a unifying theme of my thesis, then they are an emergent one. I came to graduate school from a Bachelor's in physics and a loose background in population genetics in clonal interference and in adaptive dynamics.  My statement of interest was something about stochasticity and the interface of ecology and evolution, and Chapter~\ref{fluctuationdomains} is an excellent example of my thinking at the time.  In Chapter~\ref{fluctuationdomains} (Boettiger et al. 2010) I explore the stochastic deviations from a classic result, the canonical equation of adaptive dynamics.  In what began as a nice analytical exercise, I was frustrated to find my approximations breaking down wildly when starting simulations a great distance from the evolutionary optimum.  Like so many discoveries, what I assumed was a bug in my simulation code turned out to be the heart of the result: the emergence of domains where fluctuations were enhanced, rather than dissipated, by selective forces.  The fluctuation-dissipation theorem had been central to my undergraduate physics training, and I was very happy to find an analytic expression for this boundary and a simple topological interpretation from the adaptive landscape.   This gives rise to two regimes or domains of behavior on either side of the boundary.  In the first domain evolutionary dynamics behave largely as expected, following the canonical equation of adaptive dynamics.  In the second domain, evolutionary fluctuations are enhanced, leading to evolutionary trajectories that deviate widely from the expected canonical path.  This can give rise to a bimodal distribution of outcomes, where the expected path is less common than either the much faster or much slower evolutionary trajectories.   
% Reproducible computational approaches were already important to me at this time -- I released my first R package to accompany this paper; mostly plotting functions wrapped around my C code based simulator -- though I clearly saw the analytic expressions as my central contribution. 


%Following this work I pursued another question in stochastic extensions to adaptive dynamics wherein I sought a closed-form expression for the waiting time of evolutionary branching.  Adaptive dynamics typically assumes a seperation of timescales, whereby ecologica dynamics happen infinitely faster than evolutionary ones.  To solve for the waiting time, we would have to relax this assumption to treat both ecological and evolutionary processes explicitly.  Working with Ulf Dieckmann, (a founder of this subfield) during a summer program in Vienna, Austria, I hoped that a similar stochastic expansion would allow me to find a partial differential equation (PDE) approximation of the system, from which I could find a hitting-time solution.  Again I viewed my numerical results as mere benchmarks for my pencil-and-paper approximations, though the code I wrote to efficiently handle the ecological and evolutionary dynamics at the level of the individual was some of my finest C coding.  I learned more about PDE hitting time problems, C++ data structures and parallel code, only to again find my approximations failing to match my simulations. Ignoring the significance of my numerical results, closed the book on this one unfinished.  

%A different evolutionary problem caught my attention at this time, thanks to the persistent questions of my cohort-mate Chris Martin. Chris wanted to infer the evolutionary adaptive landscape of a set of taxa using phylogenetic comparative methods. Again this involved a stochastic evolutionary model, but unlike my previous exercises I would actually be inferring model parameters and choices from real data.   

Chapter~\ref{pmc} (Boettiger et al. 2012) is representative of my work in compartive phylogenetics that formed the basis of my dissertation proposal.  Rather than derive phenomena from first principles, this chapter wrestles with the challenges of inferring evolutionary regime shifts from data.  Analytic work will still play an important role, allowing me to derive the likelihood equation for a more general set of evolutionary transitions (Beaulieu et al 2012), but this chapter focuses instead on the side of statistical inference. In this context, Different evolutionary models represent different mechanisms or hypotheses for explaining the distribution of traits we observe in related species.  The more complex models include regime shifts where the evolutionary parameters have changed in a particular group of lineages at some point in the evolutionary history.  The challenge is to identify if, when, and how frequently such shifts have occured, using only present-day trait data and phylogenetic trees. Before adding my own models to the growing library of possibilities, I sought a robust method to identify just how well our data could distinguish between this complexity.  The approaches of this chapter became central not only in establishing the validity of my later models, but also led me to see the need for more programmatic access to very large data sets, leading to the R packages and publications of rfishbase (Boettiger, Wainwright, and Temple Lang, accepted at Journal of Fish Biology) and treebase (Boettiger \& Temple Lang, accepted at Methods in Ecology and Evolution) for the purpose.   


This experience in teasing apart regime shift models in an evolutionary context echoed clearly in my mind as I encountered the growing literature on early warning signals of regime shifts in ecological collapses.  Chapter~\ref{warningsignals} (Boettiger \& Hastings 2012). Many aspects of the problem were quite different: while we have the benefit of using time-series data, rather than covariances on a phylogeny, now we would seek to identify regime shifts \emph{before} they occur. Unlike the phylogenetics literature, none of the existing approaches were model based, leading me to start once more from pencil-and-paper to derive an appropriate model from the canonical form of the underlying bifurcation.  Having learned the computational necessity of simplicity when inferring models from data, I went with the simplest approximation that could capture the essential features of the early warning.  This not only allowed me to provide the first power analysis of early warning approaches, identifying the probabilities of false positive and false negatives in the detection, but also suggested to me a more powerful model-based indicator to provide early warning of a regime shift, also presented in Chapter~\ref{warningsignals}. 





\input{../settings/boilerplate}

